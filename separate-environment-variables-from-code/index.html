<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>separate environment variables from code - ricardonunesdev</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=7170d2f312">

    <meta name="description" content="There are many benefits in separating your environment variables from your code. Protecting your private data is the most important one. #coding">
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="ricardonunesdev">
    <meta property="og:type" content="article">
    <meta property="og:title" content="separate environment variables from code - ricardonunesdev">
    <meta property="og:description" content="There are many benefits in separating your environment variables from your code. Protecting your private data is the most important one. #coding">
    <meta property="og:url" content="https://ricardonunesdev.com/separate-environment-variables-from-code/">
    <meta property="og:image" content="https://images.unsplash.com/photo-1422207049116-cfaf69531072?ixlib=rb-0.3.5&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ&amp;s=d96b1ba508a8e7925c9d9f75cd81e971">
    <meta property="article:published_time" content="2018-05-08T17:15:00.000Z">
    <meta property="article:modified_time" content="2018-10-20T15:52:04.000Z">
    <meta property="article:tag" content="coding">
    
    <meta property="article:publisher" content="https://www.facebook.com/ricardonunesdev">
    <meta property="article:author" content="https://www.facebook.com/ricardonunesdev">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="separate environment variables from code - ricardonunesdev">
    <meta name="twitter:description" content="There are many benefits in separating your environment variables from your code. Protecting your private data is the most important one. #coding">
    <meta name="twitter:url" content="https://ricardonunesdev.com/separate-environment-variables-from-code/">
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1422207049116-cfaf69531072?ixlib=rb-0.3.5&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ&amp;s=d96b1ba508a8e7925c9d9f75cd81e971">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Ricardo Nunes">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="coding">
    <meta name="twitter:site" content="@ricardonunesdev">
    <meta name="twitter:creator" content="@ricardonunesdev">
    <meta property="og:image:width" content="1080">
    <meta property="og:image:height" content="751">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "ricardonunesdev",
        "logo": {
            "@type": "ImageObject",
            "url": "https://ricardonunesdev.com/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Ricardo Nunes",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/42865bdb4e926fdc9bf1daf086f96027?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://ricardonunesdev.com/author/ricardonunesdev/",
        "sameAs": [
            "https://ricardonunesdev.com",
            "https://www.facebook.com/ricardonunesdev",
            "https://twitter.com/ricardonunesdev"
        ]
    },
    "headline": "separate environment variables from code - ricardonunesdev",
    "url": "https://ricardonunesdev.com/separate-environment-variables-from-code/",
    "datePublished": "2018-05-08T17:15:00.000Z",
    "dateModified": "2018-10-20T15:52:04.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1422207049116-cfaf69531072?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max&ixid=eyJhcHBfaWQiOjExNzczfQ&s=d96b1ba508a8e7925c9d9f75cd81e971",
        "width": 1080,
        "height": 751
    },
    "keywords": "coding",
    "description": "There are many benefits in separating your environment variables from your code. Protecting your private data is the most important one. But having different configurations for local development, staging, and production, is also a huge bonus.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://ricardonunesdev.com/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.2">
    <link rel="alternate" type="application/rss+xml" title="ricardonunesdev" href="../rss/index.html">
    <style type="text/css">
    ul { margin-top: -1em; }
    li { line-height: 1em; }
</style>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118813160-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118813160-1');
</script>

</head>
<body class="post-template tag-coding">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../">ricardonunesdev</a>
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="../">home</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-fb" href="https://www.facebook.com/ricardonunesdev" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
</a>
                <a class="social-link social-link-tw" href="https://twitter.com/ricardonunesdev" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
</a>
        </div>
            <a class="rss-button" href="https://feedly.com/i/subscription/feed/https://ricardonunesdev.com/rss/" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg>
</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-coding ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2018-05-08">8 May 2018</time>
                        <span class="date-divider">/</span> <a href="../tag/coding/">coding</a>
                </section>
                <h1 class="post-full-title">separate environment variables from code</h1>
            </header>

            <figure class="post-full-image" style="background-image: url(https://images.unsplash.com/photo-1422207049116-cfaf69531072?ixlib=rb-0.3.5&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ&amp;s=d96b1ba508a8e7925c9d9f75cd81e971)">
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>There are many benefits in separating your environment variables from your code. Protecting your private data is the most important one. But having different configurations for local development, staging, and production, is also a huge bonus.</p>
<p>If you're not separating your environment variables from your code, you should start right now. This is a quick guide on how I do it.</p>
<h2 id="whatexactlyareenvironmentvariables">What exactly are environment variables?</h2>
<p>If you're already familiar with them, feel free to skip to the next section.<br>
If not, read on.</p>
<p>Environment variables are little pieces of information (in key-value pair format) that are specific to the machine or instance where the code is running on. They are required to execute certain functions, like connecting to external services that require some authentication, or keeping private information, well, private.</p>
<p>If you have something like this in your code (taken from the <a href="https://www.npmjs.com/package/mysql">mysql</a> module instructions), then you should consider separating those variables:</p>
<pre><code class="language-javascript">const mysql      = require('mysql');
const connection = mysql.createConnection({
    host     : 'localhost',
    user     : 'me',
    password : 'secret',
    database : 'my_db'
});
</code></pre>
<p>A few examples of data that should be separated from the code:</p>
<ul>
<li>Database username and password</li>
<li>API key to an external service (like AWS or Twitter)</li>
<li>Secret salt used to encrypt your users' passwords</li>
</ul>
<p>The other huge benefit is having different environment variables on your local development machine and on your production server. Once you have them configured, you'll never have to change those values again (unless they change), saving time and headaches.</p>
<p>So separating those variables from the code will help you build a solid foundation that will work on any environment, provided there's a way to include those variables at runtime.</p>
<h2 id="howtoactuallyseparatethem">How to actually separate them?</h2>
<p>I'm going to provide examples for Node.js running on Ubuntu 18.04, but practically every programming language and operating system allows for this in some way. Adjust the instructions to your setup.</p>
<p>There are three ways to do this. With a <code>.env</code> file, using <code>export</code>, or setting them when you run your code.</p>
<h3 id="atruntime">At runtime</h3>
<p>If you only want to set the variables at runtime, just start the Node.js process like this:</p>
<pre><code>DB_HOST=localhost DB_USER=me DB_PASS=secret DB_NAME=my_db node index.js
</code></pre>
<p>Where <code>DB_HOST</code> is a variable and <code>localhost</code> is its value.</p>
<p>This is also the method used by application hosting services like <a href="https://docs.aws.amazon.com/lambda/latest/dg/env_variables.html#env_setting_up">AWS Lambda</a> and <a href="https://devcenter.heroku.com/articles/config-vars#setting-up-config-vars-for-a-deployed-application">Heroku</a>, where you configure the environment variables on their UI or console, and they're initialized before your code is started.</p>
<h3 id="beforerunning">Before running</h3>
<p>If you want to set up the variables for a session of development, initialize them before starting the Node.js process:</p>
<pre><code>export DB_HOST=localhost
export DB_USER=me
export DB_PASS=secret
export DB_NAME=my_db
node index.js
</code></pre>
<p>The main advantage of this method is that the variables are persistent while your session is open, even through multiple starts of your application. As soon as you close your terminal or console, those variables are gone, and you need to set them up again.</p>
<p>To test if a variable is set up, just echo it in the console:</p>
<pre><code>echo $DB_HOST
</code></pre>
<p>If you've done everything correctly, it should output <code>localhost</code>.</p>
<h3 id="persistently">Persistently</h3>
<p>To keep those variables through multiple sessions and even restarts, you have to store them in a <code>.env</code> file. Just create it in the root folder of your project and add the variables in the same format.</p>
<pre><code class="language-bash">DB_HOST=localhost
DB_USER=me
DB_PASS=secret
DB_NAME=my_db
</code></pre>
<h2 id="usingthevariablesinyourcode">Using the variables in your code</h2>
<p>If you're using the persistent method above (which you should), in Node.js the easiest, quickest, and most foolproof way to do this is with the <code>dotenv</code> module. It will manage the loading of the environment file and assign those values to specific variables that can later be used where needed in your code.</p>
<p>Just install the module, in the root folder of your project:</p>
<pre><code>npm i dotenv --save
</code></pre>
<p>Include the module on the first line of your main file:</p>
<pre><code class="language-javascript">require('dotenv').config();
</code></pre>
<p>The environment variables will then be available under the <code>process.env</code> object. Just insert them exactly where the values are supposed to be:</p>
<pre><code class="language-javascript">const mysql      = require('mysql');
const connection = mysql.createConnection({
    host     : process.env.DB_HOST,
    user     : process.env.DB_USER,
    password : process.env.DB_PASS,
    database : process.env.DB_NAME
});
</code></pre>
<p>Check the official <a href="https://www.npmjs.com/package/dotenv">dotenv</a> module page for additional information and instructions.</p>
<h2 id="protectyourdata">Protect your data</h2>
<p>If your project is under control version (as it should be), add the <code>.env</code> file to your ignore file. Here's an example of <code>.gitignore</code> file for those of you using Git:</p>
<pre><code>node_modules/
.env
</code></pre>
<p>If it isn't, just make sure you don't upload your <code>.env</code> anywhere or send it to someone else.</p>
<p>Now your private data is safe and away from prying eyes.</p>
<p>You can create a different <code>.env</code> file on your production server than the one on your local development machine, with different values of the same variables and everything will work as it should.</p>
<p>If after following these instruction you still can't make it work, send me a <a href="https://twitter.com/ricardonunesdev">tweet</a>, <a href="https://www.facebook.com/ricardonunesdev">facebook</a> message, or <a href="mailto:ricardonunesdev@gmail.com?subject=%5BBlog%5D%20Environment%20variables">email</a>, and I'll try my best to help you set it up.</p>

                </div>
            </section>


            <footer class="post-full-footer">


                    
<section class="author-card">
        <img class="author-profile-image" src="http://www.gravatar.com/avatar/42865bdb4e926fdc9bf1daf086f96027?s=250&amp;d=mm&amp;r=x" alt="Ricardo Nunes">
    <section class="author-card-content">
        <h4 class="author-card-name"><a href="../author/ricardonunesdev/">Ricardo Nunes</a></h4>
            <p>Read <a href="../author/ricardonunesdev/">more posts</a> by this author.</p>
    </section>
</section>
<div class="post-full-footer-right">
    <a class="author-card-button" href="../author/ricardonunesdev/">Read More</a>
</div>


            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
<script>console.error("The {{get}} helper is not available. The Public API flag must be enabled in labs if you wish to use the {{get}} helper. See https://help.ghost.org/hc/en-us/articles/115000301672-Public-API-Beta");</script>

                <article class="post-card post tag-blogging">
        <a class="post-card-image-link" href="../starting-a-new-adventure/">
            <div class="post-card-image" style="background-image: url(../content/images/2018/05/terrah-holly-241981-unsplash.jpg)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../starting-a-new-adventure/">
            <header class="post-card-header">
                    <span class="post-card-tags">blogging</span>
                <h2 class="post-card-title">starting a new adventure</h2>
            </header>
            <section class="post-card-excerpt">
                <p>I've been thinking about starting a blog for a long time now. A place where I could write down my thoughts, ideas, and things that I've learned. Most of my work involves coding (I'm a web developer, by the way), and learning is a part of my everyday process.</p>
            </section>
        </a>
        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Ricardo Nunes
                    </div>

                        <a href="../author/ricardonunesdev/" class="static-avatar"><img class="author-profile-image" src="http://www.gravatar.com/avatar/42865bdb4e926fdc9bf1daf086f96027?s=250&amp;d=mm&amp;r=x" alt="Ricardo Nunes"></a>
                </li>
            </ul>

            <span class="reading-time">3 min read</span>

        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../">
            <span>ricardonunesdev</span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">separate environment variables from code</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=separate%20environment%20variables%20from%20code&amp;url=https://ricardonunesdev.com/separate-environment-variables-from-code/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://ricardonunesdev.com/separate-environment-variables-from-code/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress id="reading-progress" class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">ricardonunesdev</a> © 2018</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    <a href="https://www.facebook.com/ricardonunesdev" target="_blank" rel="noopener">Facebook</a>
                    <a href="https://twitter.com/ricardonunesdev" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script>
        var images = document.querySelectorAll('.kg-gallery-image img');
        images.forEach(function (image) {
            var container = image.closest('.kg-gallery-image');
            var width = image.attributes.width.value;
            var height = image.attributes.height.value;
            var ratio = width / height;
            container.style.flex = ratio + ' 1 0%';
        })
    </script>


    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=7170d2f312"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('#reading-progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();

});
</script>


    <script type="text/javascript">
$('a').each(function() {
   var a = new RegExp('/' + window.location.host + '/');
   if(!a.test(this.href)) {
       $(this).click(function(event) {
           event.preventDefault();
           event.stopPropagation();
           window.open(this.href, '_blank');
       });
   }
});
</script>

</body>
</html>
